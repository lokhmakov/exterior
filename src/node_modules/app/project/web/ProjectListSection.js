import React, { Component } from 'react'
import uuid                 from 'uuid/v4'


import projectQuery         from 'app/project/api/local/query'
import projectCreate        from 'app/project/api/local/create'
import ProjectList          from 'app/project/web/ProjectList'

import Mutation             from 'core/mutation/web/Mutation'
import Query                from 'core/query/web/Query'


class ProjectListSection extends Component {
  onAdd = (payload) => {
    console.log(`ProjectListSection`, payload)
  }

  renderProjectQuery = ({ data, order }) => {
    return (
      <Mutation
        name='projectCreate'
        entity='project'

        mutation={ projectCreate }
      >
        {({ mutate }) => (
          <ProjectList
            data={ data }
            order={ order }

            onAdd={
              ({ imageLink }) => {
                mutate({
                  id: uuid(),

                  imageLink,
                })
              }
            }
            onClick={ this.props.onClick }
          />
        )}
      </Mutation>
    )
  }

  render() {
    const { onClick } = this.props

    return (
      <div>
        <h2>Проекты</h2>
        <Query
          name='projectQuery'
          entity='project'

          query={ projectQuery }
        >
          { this.renderProjectQuery }
        </Query>
      </div>
    )
  }
}

export default ProjectListSection