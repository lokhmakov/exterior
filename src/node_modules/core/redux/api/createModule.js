import create               from './create'
import remove               from './remove'
import update               from './update'


export default (payload) => {
  const {
    name,
    override = {},
  } = payload

  const reduxList = (
    override.reduxList ||
    [
      create,
      remove,
      update,
    ]
  ).map(item => item({ name }))

  const types = reduxList.reduce((prev, item) => ({ ...prev, ...item.types }), {})
  const sagaList = reduxList.map(item => item.saga())
  const reducerMap = reduxList.reduce((prev, item) => ({ ...prev, ...item.reducerMap }), {})

  const STATE = {
  }

  const reducer = (state = STATE, action) => {
    const { type } = action
    if (reducerMap[type]) return reducerMap[type](state, action)
    return state
  }

  return {
    reducer,
    sagaList,
    types,
  }
}
